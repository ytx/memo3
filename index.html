<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>memo3</title>
  <link rel="stylesheet" href="node_modules/material-symbols/outlined.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- サイドバー -->
    <div class="sidebar">
      <!-- ワークスペースセレクター -->
      <div class="workspace-selector">
        <div class="workspace-dropdown" id="workspace-dropdown">
          <button class="workspace-current" id="workspace-current-btn">
            <span class="material-symbols-outlined workspace-icon">folder</span>
            <span id="workspace-current-name">memo3</span>
            <span class="dropdown-arrow">▼</span>
          </button>
          <div class="workspace-menu" id="workspace-menu" style="display: none;">
            <!-- ワークスペースリストが動的に追加される -->
          </div>
        </div>
      </div>

      <div class="search-container">
        <div class="search-box">
          <span class="material-symbols-outlined search-icon">search</span>
          <input type="text" id="search-input" placeholder="ファイル名・本文検索...">
          <button id="clear-search-btn" class="btn-clear" title="検索をクリア">×</button>
        </div>
        <button id="toggle-tags-btn" class="btn-toggle-tags" title="タグフィルター"><span class="material-symbols-outlined">sell</span></button>
      </div>

      <div class="tag-filter" id="tag-filter" style="display: none;">
        <div class="tag-filter-header">
          <span>タグフィルター</span>
          <button id="clear-tag-filter-btn" class="btn-clear-filter" title="フィルターをクリア">クリア</button>
        </div>
        <div class="tag-list" id="tag-list">
          <!-- タグリストが動的に追加される -->
        </div>
      </div>

      <div class="search-results" id="search-results" style="display: none;">
        <!-- 検索結果がここに表示される -->
      </div>
      
      <div class="file-list" id="file-list">
        <!-- ファイルリストがここに動的に追加される -->
      </div>
    </div>
    
    <!-- エディタエリア -->
    <div class="editor-container">
      <div class="editor-header">
        <div class="file-info">
          <div class="folder-path" id="root-folder-path">フォルダを選択してください</div>
          <div class="file-path-container">
            <div class="file-path" id="current-file-path">ファイルが選択されていません</div>
            <div class="file-tags-display" id="file-tags-display"></div>
            <button id="edit-file-tags-btn" class="btn-icon-small" title="タグを編集" style="display: none;">
              <span class="material-symbols-outlined">sell</span>
            </button>
          </div>
        </div>
        <div class="editor-actions">
          <button id="preview-btn" class="btn-icon btn-flat" title="プレビュー">
            <span class="material-symbols-outlined">preview</span>
          </button>
          <button id="theme-toggle-btn" class="btn-icon btn-flat" title="テーマ切り替え">
            <span class="material-symbols-outlined">routine</span>
          </button>
          <button id="toggle-whitespace-btn" class="btn-icon" title="空白文字の表示/非表示">
            <span class="material-symbols-outlined">space_bar</span>
          </button>
          <button id="font-decrease-btn" class="btn-icon" title="フォントサイズを小さく">
            <span class="material-symbols-outlined">text_decrease</span>
          </button>
          <button id="font-increase-btn" class="btn-icon" title="フォントサイズを大きく">
            <span class="material-symbols-outlined">text_increase</span>
          </button>
          <button id="settings-btn" class="btn-icon btn-flat" title="設定">
            <span class="material-symbols-outlined">settings</span>
          </button>
          <button id="update-btn" class="btn-icon btn-flat" title="新しいバージョンが利用可能です" style="display: none;">
            <span class="material-symbols-outlined" style="color: #ff4444;">browser_updated</span>
          </button>
        </div>
      </div>
      
      <!-- タブバー -->
      <div class="tab-bar" id="tab-bar">
        <button id="tab-scroll-left" class="tab-scroll-btn" title="左へスクロール">‹</button>
        <div class="tab-list" id="tab-list">
          <!-- タブがここに動的に追加される -->
        </div>
        <button id="tab-scroll-right" class="tab-scroll-btn" title="右へスクロール">›</button>
        <div class="tab-actions">
          <button id="new-tab-btn" class="btn-tab" title="新しいメモを作成">+</button>
        </div>
      </div>
      
      <!-- エディタコンテナ -->
      <div class="editor-workspace" id="editor-workspace">
        <!-- エディタがここに動的に追加される -->
        <div class="editor-empty-state" id="editor-empty-state">
          <button id="empty-state-new-btn" class="btn-empty-state" title="新しいメモを作成">
            <span class="empty-state-icon">+</span>
            <span class="empty-state-text">新しいメモを作成</span>
          </button>
        </div>
      </div>
      
      <div class="status-bar">
        <span id="status-text">Ready</span>
        <span id="word-count">Words: 0</span>
        <span id="char-count">Chars: 0</span>
      </div>
    </div>
  </div>
  
  <!-- 設定ダイアログ -->
  <div id="settings-dialog" class="dialog hidden">
    <div class="dialog-content settings-dialog-content">
      <h2>設定</h2>

      <!-- タブナビゲーション -->
      <div class="settings-tabs">
        <button class="settings-tab active" data-tab="editor">エディタ</button>
        <button class="settings-tab" data-tab="tags">タグ</button>
        <button class="settings-tab" data-tab="about">About</button>
      </div>

      <!-- タブコンテンツ -->
      <div class="settings-tab-content">
        <!-- エディタタブ -->
        <div id="settings-tab-editor" class="settings-tab-pane active">
          <div class="settings-group">
            <label for="keybinding-select">キーバインド:</label>
            <select id="keybinding-select">
              <option value="">標準</option>
              <option value="ace/keyboard/vim">Vim</option>
              <option value="ace/keyboard/emacs">Emacs</option>
              <option value="ace/keyboard/sublime">Sublime</option>
              <option value="ace/keyboard/vscode">VSCode</option>
            </select>
          </div>

          <div class="settings-group">
            <label for="theme-select">テーマ1:</label>
            <select id="theme-select">
              <option value="ace/theme/monokai">Monokai</option>
              <option value="ace/theme/github">GitHub</option>
              <option value="ace/theme/tomorrow">Tomorrow</option>
              <option value="ace/theme/twilight">Twilight</option>
              <option value="ace/theme/solarized_dark">Solarized Dark</option>
              <option value="ace/theme/solarized_light">Solarized Light</option>
              <option value="ace/theme/dracula">Dracula</option>
            </select>
          </div>

          <div class="settings-group">
            <label for="theme-preset2">テーマ2:</label>
            <select id="theme-preset2">
              <option value="ace/theme/monokai">Monokai</option>
              <option value="ace/theme/github">GitHub</option>
              <option value="ace/theme/tomorrow">Tomorrow</option>
              <option value="ace/theme/twilight">Twilight</option>
              <option value="ace/theme/solarized_dark">Solarized Dark</option>
              <option value="ace/theme/solarized_light">Solarized Light</option>
              <option value="ace/theme/dracula">Dracula</option>
            </select>
          </div>

          <div class="settings-group">
            <label for="font-size">フォントサイズ:</label>
            <input type="number" id="font-size" min="10" max="30" value="14">
          </div>

          <div class="settings-group">
            <label for="line-height">行間:</label>
            <input type="number" id="line-height" min="1.0" max="2.5" step="0.1" value="1.5">
          </div>

          <div class="settings-group">
            <label>
              <input type="checkbox" id="word-wrap">
              折り返し表示
            </label>
          </div>

          <div class="settings-group">
            <label>
              <input type="checkbox" id="show-line-numbers">
              行番号を表示
            </label>
          </div>
        </div>

        <!-- タグタブ -->
        <div id="settings-tab-tags" class="settings-tab-pane">
          <div class="settings-group">
            <label>タグ検索:</label>
            <div class="tag-search-box">
              <input type="text" id="settings-tag-search-input" placeholder="タグを検索... (Enterで新規作成)">
              <button id="settings-tag-search-clear-btn" class="btn-clear" title="クリア">×</button>
            </div>
          </div>

          <div class="settings-group">
            <label>タグ一覧:</label>
            <div id="settings-tag-list" class="settings-tag-list">
              <!-- タグリストが表示される -->
            </div>
          </div>
        </div>

        <!-- Aboutタブ -->
        <div id="settings-tab-about" class="settings-tab-pane">
          <div style="text-align: center; padding: 20px 0;">
            <div style="font-size: 32px; font-weight: 600; color: var(--text-color); margin-bottom: 10px;">
              memo3
            </div>
            <div style="font-size: 16px; color: var(--text-secondary-color); margin-bottom: 30px;">
              バージョン <span id="about-version">読み込み中...</span>
            </div>
          </div>

          <div style="max-width: 400px; margin: 0 auto;">
            <a href="#" id="about-github-link" style="display: flex; align-items: center; padding: 16px; margin-bottom: 12px; background: var(--sidebar-color); border-radius: 8px; text-decoration: none; color: var(--text-color); transition: all 0.2s;">
              <span class="material-symbols-outlined" style="font-size: 24px; margin-right: 16px; color: #007acc;">code</span>
              <div style="flex: 1;">
                <div style="font-weight: 500; margin-bottom: 2px;">GitHub リポジトリ</div>
                <div style="font-size: 12px; color: var(--text-secondary-color);">ソースコードを見る</div>
              </div>
            </a>

            <a href="#" id="about-download-link" style="display: flex; align-items: center; padding: 16px; margin-bottom: 12px; background: var(--sidebar-color); border-radius: 8px; text-decoration: none; color: var(--text-color); transition: all 0.2s;">
              <span class="material-symbols-outlined" style="font-size: 24px; margin-right: 16px; color: #007acc;">download</span>
              <div style="flex: 1;">
                <div style="font-weight: 500; margin-bottom: 2px;">ダウンロードサイト</div>
                <div style="font-size: 12px; color: var(--text-secondary-color);">最新版を入手</div>
              </div>
            </a>

            <a href="#" id="about-coffee-link" style="display: flex; align-items: center; padding: 16px; background: var(--sidebar-color); border-radius: 8px; text-decoration: none; color: var(--text-color); transition: all 0.2s;">
              <span class="material-symbols-outlined" style="font-size: 24px; margin-right: 16px; color: #007acc;">coffee</span>
              <div style="flex: 1;">
                <div style="font-weight: 500; margin-bottom: 2px;">Buy Me A Coffee</div>
                <div style="font-size: 12px; color: var(--text-secondary-color);">開発を支援する</div>
              </div>
            </a>
          </div>
        </div>
      </div>

      <div class="dialog-actions">
        <button id="save-settings-btn" class="btn-primary">保存</button>
        <button id="cancel-settings-btn" class="btn-secondary">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- タグ管理ダイアログ -->
  <div id="tag-dialog" class="dialog hidden">
    <div class="dialog-content tag-dialog-content">
      <!-- 検索/追加ボックス -->
      <div class="tag-search-box">
        <input type="text" id="tag-search-input" placeholder="タグを検索または追加...">
        <button id="tag-search-clear-btn" class="btn-clear" title="クリア">×</button>
      </div>

      <!-- タグ表示エリア -->
      <div class="tag-flow-area" id="tag-flow-area">
        <!-- タグがフローレイアウトで表示される -->
      </div>

      <div class="dialog-actions">
        <button id="tag-dialog-close-btn" class="btn-primary">閉じる</button>
      </div>
    </div>
  </div>

  <!-- タグ編集ダイアログ -->
  <div id="edit-tag-dialog" class="dialog hidden">
    <div class="dialog-content">
      <h2>タグを編集</h2>
      <div class="settings-group">
        <label for="edit-tag-name-input">タグ名:</label>
        <input type="text" id="edit-tag-name-input" placeholder="タグ名">
      </div>
      <div class="settings-group">
        <label for="edit-tag-color-palette">色:</label>
        <div style="display: flex; gap: 10px; align-items: flex-start;">
          <div id="edit-tag-color-palette" class="color-palette">
            <!-- 色パレットが動的に追加される -->
          </div>
          <div id="edit-tag-color-preview" style="padding: 6px 14px; border-radius: 12px; color: white; font-size: 13px; flex-shrink: 0;">プレビュー</div>
        </div>
      </div>
      <div class="dialog-actions">
        <button id="edit-tag-save-btn" class="btn-primary">保存</button>
        <button id="edit-tag-cancel-btn" class="btn-secondary">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- 表編集ダイアログ -->
  <div id="table-editor-dialog" class="dialog hidden">
    <div class="dialog-content table-editor-content">
      <h2>表を編集</h2>

      <!-- ツールバー -->
      <div class="table-toolbar">
        <button id="table-add-row-above" class="btn-secondary">+行(上)</button>
        <button id="table-add-row-below" class="btn-secondary">+行(下)</button>
        <button id="table-delete-row" class="btn-secondary">行削除</button>
        <button id="table-add-col-left" class="btn-secondary">+列(左)</button>
        <button id="table-add-col-right" class="btn-secondary">+列(右)</button>
        <button id="table-delete-col" class="btn-secondary">列削除</button>
      </div>

      <!-- 表編集エリア -->
      <div class="table-editor-area" id="table-editor-area">
        <!-- 動的に生成されるテーブル -->
      </div>

      <!-- アクションボタン -->
      <div class="dialog-actions">
        <button id="table-editor-save-btn" class="btn-primary">保存</button>
        <button id="table-editor-cancel-btn" class="btn-secondary">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- コンテキストメニュー -->
  <div id="context-menu" class="context-menu">
    <div id="context-edit-tags" class="context-menu-item">タグを編集</div>
    <div id="context-rename" class="context-menu-item">ファイル名更新</div>
    <div id="context-delete" class="context-menu-item danger">削除</div>
  </div>


  <!-- ステータスバー用コンテキストメニュー -->
  <div id="status-context-menu" class="context-menu">
    <div id="status-devtools" class="context-menu-item">開発者ツール</div>
  </div>
  
  <!-- タブ用コンテキストメニュー -->
  <div id="tab-context-menu" class="context-menu">
    <div id="tab-close-all" class="context-menu-item">すべてのタブを閉じる</div>
  </div>
  
  <script src="node_modules/ace-builds/src-min-noconflict/ace.js"></script>
  <script src="node_modules/ace-builds/src-min-noconflict/ext-language_tools.js"></script>
  <script src="renderer.js"></script>
</body>
</html>